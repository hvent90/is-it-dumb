DESCRIPTION >
    Issue category breakdown for a specific model_name.
    Accepts model_name parameter and returns count of reports by issue category.

PARAMETERS >
    model_name String

NODE reports_deduped
SQL >
    SELECT
        session_id,
        argMax(model_name, timestamp) as model_name,
        argMax(issue_category, timestamp) as issue_category,
        argMax(severity, timestamp) as severity
    FROM llm_events
    WHERE event_type = 'report'
    GROUP BY session_id

NODE issue_breakdown
SQL >
    SELECT
        issue_category,
        count() as report_count
    FROM reports_deduped
    WHERE model_name = {{ String(model_name) }}
        AND issue_category != '' AND issue_category IS NOT NULL
    GROUP BY issue_category
    ORDER BY report_count DESC